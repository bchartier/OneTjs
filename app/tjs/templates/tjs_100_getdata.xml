<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<GDAS service="TJS"
      version="1.0"
      capabilities="{{ get_service_url(service) }}"
      xml:lang="en"
      xmlns="http://www.opengis.net/tjs/1.0"
      xmlns:ows="http://www.opengis.net/ows/1.1"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.opengis.net/tjs/1.0 http://schemas.opengis.net/tjs/1.0/tjsGetData_response.xsd">
    <Framework>
        <FrameworkURI>{{ framework.uri }}</FrameworkURI>
        <Organization>{{ framework.organization }}</Organization>
        <Title>{{ framework.title }}</Title>
        <Abstract>{{ framework.abstract }}</Abstract>
        <ReferenceDate startDate="{{ framework.reference_date }}">{{ framework.start_date }}</ReferenceDate>
        <Version>{{ framework.version }}</Version>
{% if framework.documentation is not none %}
        <Documentation>{{ framework.documentation }}</Documentation>
{% endif %}
        <FrameworkKey>
            <Column name="{{ framework.key_col['name']}}" type="{{ framework.key_col['type'] }}" length="{{ framework.key_col['length'] }}" decimals="{{ framework.key_col['decimals'] }}" />
        </FrameworkKey>
        <BoundingCoordinates>
        <North>{{ framework.bbox["north"] }}</North>
        <South>{{ framework.bbox["south"] }}</South>
        <East>{{ framework.bbox["east"] }}</East>
        <West>{{ framework.bbox["west"] }}</West>
        </BoundingCoordinates>
        <DescribeDatasetsRequest xlink:href="{{ get_describedatasets_url(service, tjs_version, framework) }}"/>
        <Dataset>
            <DatasetURI>{{ dataset.uri }}</DatasetURI>
            <Organization>{{ dataset.organization }}</Organization>
            <Title>{{ dataset.title }}</Title>
            <Abstract>{{ dataset.abstract }}</Abstract>
            <ReferenceDate>{{ dataset.reference_date }}</ReferenceDate>
            <Version>{{ dataset.version }}</Version>
{% if dataset.documentation is not none %}
            <Documentation>{{ dataset.documentation }}</Documentation>
{% endif %}
            <DescribeDataRequest xlink:href="{{ get_describedata_url(service, tjs_version, dataset) }}"/>
            <Columnset>
                <!--Need a loop on all framework keys of the dataset?-->
                <FrameworkKey complete="{% if dataset.framework_complete %}true{% else %}false{% endif %}" relationship="{{ dataset.framework_relationship }}">
                    <Column name="{{ framework.key_col['name']}}" type="{{ framework.key_col['type'] }}" length="{{ framework.key_col['length'] }}" decimals="{{ framework.key_col['decimals'] }}" />
                </FrameworkKey>
                <Attributes>
{% for attribute in attributes %}
                    <Column name="{{ attribute.name }}" type="http://www.w3.org/TR/xmlschema-2/#integer" length="10" decimals="0" purpose="Attribute">
                        <Title>{{ attribute.title }}</Title>
                        <Abstract>{{ attribute.abstract }}</Abstract>
                        <!--Documentation>{{ attribute.documentation }}</Documentation-->
                        <Values>
{{ attribute.values }}
                        </Values>
                        <GetDataRequest xlink:href="{{ get_getdata_url(service, tjs_version, attribute) }}"/>
                    </Column>
{% endfor %}
    </Attributes>
   </Columnset>
   <Rowset>
{% for row in data.itertuples() %}
     <Row>
       <K>{{ row[0] }}</K>
{% for col in data.columns %}
       <V>{{ row[col] }}</V>
{% endfor %}
     </Row>
{% endfor %}
   </Rowset>
  </Dataset>
 </Framework>
</GDAS>
